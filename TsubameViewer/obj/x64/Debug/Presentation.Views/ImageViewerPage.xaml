<Page x:ConnectionId='1'
    x:Class="TsubameViewer.Presentation.Views.ImageViewerPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:TsubameViewer.Presentation.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
  xmlns:i="using:Microsoft.Xaml.Interactivity" 
  xmlns:core="using:Microsoft.Xaml.Interactions.Core"
  xmlns:myConv="using:TsubameViewer.Presentation.Views.Converters"
  xmlns:wst="using:WindowsStateTriggers" 
  xmlns:uwpControls="using:Microsoft.Toolkit.Uwp.UI.Controls"
  xmlns:myBehaviour="using:TsubameViewer.Presentation.Views.Behaviors"
  xmlns:uwpUIExtensions="using:Microsoft.Toolkit.Uwp.UI" 
  xmlns:uiNavigation="using:TsubameViewer.Presentation.Views.UINavigation"
  xmlns:domainModels="using:TsubameViewer.Models.Domain" 
  xmlns:myStateTriggers="using:TsubameViewer.Presentation.Views.StateTrigger" 
  xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
  xmlns:i18nExt="using:I18NPortable.Xaml.Extensions" 
  xmlns:models="using:TsubameViewer.Models.Domain.FolderItemListing" 
  xmlns:viewModels="using:TsubameViewer.Presentation.ViewModels" 
  xmlns:animation="using:Microsoft.Toolkit.Uwp.UI.Animations"
  xmlns:behaviours="using:Microsoft.Toolkit.Uwp.UI.Behaviors"
  xmlns:system="http://schemas.microsoft.com/winfx/2009/xaml"
  xmlns:Windows10version1903="http://schemas.microsoft.com/winfx/2006/xaml/presentation?IsApiContractPresent(Windows.Foundation.UniversalApiContract, 8)" xmlns:fluentIcon="using:Fluent.Icons"
  mc:Ignorable="d"
    Background="{ThemeResource ApplicationContentBackgroundBrush}"
  >

  
  <i:Interaction.Behaviors>
    <core:EventTriggerBehavior EventName="Unloaded">
      
    </core:EventTriggerBehavior>
  </i:Interaction.Behaviors>
  
  
  <Page.Resources>

    <myConv:SliderValueChangedEventArgsConverter x:Key="SliderValueChangedEventArgsConverter" />

    <MenuFlyout x:Key="OtherSettingsFlyout" Placement="BottomEdgeAlignedRight">
      <MenuFlyoutItem Text="No Item" IsEnabled="False" />
    </MenuFlyout>

    <Flyout x:Key="PageFlyout">

      <StackPanel Spacing="16">

        
        
        

        <TextBlock Text="{i18nExt:Localize Key=FileSortTitle}" />
        <DropDownButton x:ConnectionId='10' x:Name="FileSortButton" 
                                                                                                                                        
                            Background="Transparent"
                            >
          <DropDownButton.Flyout>
            <MenuFlyout>
              <MenuFlyoutItem x:ConnectionId='13' Text="{i18nExt:Localize Key=Sort_Unselected}"                                             
                              CommandParameter="{x:Null}" />
              
              <MenuFlyoutItem x:ConnectionId='14' Text="{i18nExt:Localize Key=FileSortType.UpdateTimeDecending}"                                             >
                <MenuFlyoutItem.CommandParameter>
                  <models:FileSortType>UpdateTimeDecending</models:FileSortType>
                </MenuFlyoutItem.CommandParameter>
              </MenuFlyoutItem>
              <MenuFlyoutItem x:ConnectionId='15' Text="{i18nExt:Localize Key=FileSortType.UpdateTimeAscending}"                                             >
                <MenuFlyoutItem.CommandParameter>
                  <models:FileSortType>UpdateTimeAscending</models:FileSortType>
                </MenuFlyoutItem.CommandParameter>
              </MenuFlyoutItem>
              <MenuFlyoutItem x:ConnectionId='16' Text="{i18nExt:Localize Key=FileSortType.TitleAscending}"                                             >
                <MenuFlyoutItem.CommandParameter>
                  <models:FileSortType>TitleAscending</models:FileSortType>
                </MenuFlyoutItem.CommandParameter>
              </MenuFlyoutItem>
              <MenuFlyoutItem x:ConnectionId='17' Text="{i18nExt:Localize Key=FileSortType.TitleDecending}"                                             >
                <MenuFlyoutItem.CommandParameter>
                  <models:FileSortType>TitleDecending</models:FileSortType>
                </MenuFlyoutItem.CommandParameter>
              </MenuFlyoutItem>
            </MenuFlyout>
          </DropDownButton.Flyout>
        </DropDownButton>

        <Border x:ConnectionId='11' uwpControls:DockPanel.Dock="Top"                                                                                                                                   >
          <TextBlock Opacity="0.7" TextWrapping="Wrap">
              <Run Text="{i18nExt:Localize Key=Sort_InheritancePath}" /> <LineBreak /> <Run x:ConnectionId='12'                                                                 />
          </TextBlock>
        </Border>

      </StackPanel>
    </Flyout>

    

    <MenuFlyout x:Key="DesktopViewManagementFlyout">
      <MenuFlyoutItem x:ConnectionId='9' Command="{StaticResource FullScreenToggleUICommand}"
                      x:Name="SwitchFullScreeMenuItem"
                      Visibility="Collapsed"
                      >
      </MenuFlyoutItem>
    </MenuFlyout>

    <XamlUICommand x:ConnectionId='2' x:Key="ZoomResetUICommand"                                    
                   Label="{i18nExt:Localize Key=ZoomReset}"   
                   >
      <XamlUICommand.IconSource>
        <SymbolIconSource Symbol="Zoom" />
      </XamlUICommand.IconSource>
      <XamlUICommand.KeyboardAccelerators>

      </XamlUICommand.KeyboardAccelerators>
    </XamlUICommand>
    
    <XamlUICommand x:ConnectionId='3' x:Key="ZoomInUICommand"                                               
                   Label="{i18nExt:Localize Key=ZoomIn}"   
                   >
      <XamlUICommand.IconSource>
        <SymbolIconSource Symbol="ZoomIn" />
      </XamlUICommand.IconSource>
      <XamlUICommand.KeyboardAccelerators>
        
      </XamlUICommand.KeyboardAccelerators>
    </XamlUICommand>

    <XamlUICommand x:ConnectionId='4' x:Key="ZoomOutUICommand"                                                 
                   Label="{i18nExt:Localize Key=ZoomOut}"                   
                   >
      <XamlUICommand.IconSource>
        <SymbolIconSource Symbol="ZoomOut" />
      </XamlUICommand.IconSource>
      <XamlUICommand.KeyboardAccelerators>

      </XamlUICommand.KeyboardAccelerators>
    </XamlUICommand>


    <XamlUICommand x:ConnectionId='5' x:Key="FullScreenToggleUICommand"                                               
                   Label="{i18nExt:Localize Key=SwitchFullScreen}"     
                   >
      <XamlUICommand.IconSource>
        <fluentIcon:FluentIconSource Symbol="FullScreenMaximize24" />
      </XamlUICommand.IconSource>
      <XamlUICommand.KeyboardAccelerators>
        <KeyboardAccelerator Key="F11" />
      </XamlUICommand.KeyboardAccelerators>
    </XamlUICommand>

    <XamlUICommand x:ConnectionId='6' x:Key="LeftBindingToggleUICommand"                                                
                   Label="{i18nExt:Localize Key=IsLeftBindingView}"
                   Description="{i18nExt:Localize Key=IsLeftBindingView}"
                   >
      <XamlUICommand.IconSource>
        <fluentIcon:FluentIconSource Symbol="ArrowSort24" />
      </XamlUICommand.IconSource>
      <XamlUICommand.KeyboardAccelerators>
      </XamlUICommand.KeyboardAccelerators>
    </XamlUICommand>
    
    <XamlUICommand x:ConnectionId='7' x:Key="DoubleViewToggleUICommand"                                               
                   Label="{i18nExt:Localize Key=IsEnableDoubleView}"
                   Description="{i18nExt:Localize Key=IsEnableDoubleView}"
                   >
      <XamlUICommand.IconSource>
        <SymbolIconSource Symbol="TwoPage" />
      </XamlUICommand.IconSource>
      <XamlUICommand.KeyboardAccelerators>
      </XamlUICommand.KeyboardAccelerators>
    </XamlUICommand>


    <XamlUICommand x:ConnectionId='8' x:Key="DoubleViewCorrectUICommand"                                                
                   Label="{i18nExt:Localize Key=DoubleViewCorrectPaging}"
                   Description="{i18nExt:Localize Key=DoubleViewCorrectPaging}"
                   >
      <XamlUICommand.IconSource>
        <SymbolIconSource Symbol="Page2" />
      </XamlUICommand.IconSource>
      <XamlUICommand.KeyboardAccelerators>
      </XamlUICommand.KeyboardAccelerators>
    </XamlUICommand>
    
  </Page.Resources>

  <!-- Note: IsHitTestVisible="True" Background="Transparent" が無いと
             マウススクロールが反応しない問題が発生する 
  -->
  <Grid x:ConnectionId='18' x:Name="RootGrid" uwpUIExtensions:FrameworkElementExtensions.EnableActualSizeBinding="True"
        IsHitTestVisible="True" Background="Transparent"
        ContextFlyout="{StaticResource DesktopViewManagementFlyout}"
        >
    
    <i:Interaction.Behaviors>
      
      <!-- Mouse Input-->
      <myBehaviour:MouseWheelTrigger x:ConnectionId='19' x:Name="DefaultMouseWheelTrigger">
        <myBehaviour:MouseWheelTrigger.UpActions>
          <core:InvokeCommandAction x:ConnectionId='48'                                           />
        </myBehaviour:MouseWheelTrigger.UpActions>
        <myBehaviour:MouseWheelTrigger.DownActions>
          <core:InvokeCommandAction x:ConnectionId='49'                                                         />
        </myBehaviour:MouseWheelTrigger.DownActions>
      </myBehaviour:MouseWheelTrigger>
      <myBehaviour:MouseWheelTrigger x:ConnectionId='20' x:Name="ReverseMouseWheelTrigger" IsEnabled="False">
        <myBehaviour:MouseWheelTrigger.UpActions>
          <core:InvokeCommandAction x:ConnectionId='46'                                                         />
        </myBehaviour:MouseWheelTrigger.UpActions>
        <myBehaviour:MouseWheelTrigger.DownActions>
          <core:InvokeCommandAction x:ConnectionId='47'                                                         />
        </myBehaviour:MouseWheelTrigger.DownActions>
      </myBehaviour:MouseWheelTrigger>
      <myBehaviour:MouseCenterClickTrigger>
        <core:InvokeCommandAction Command="{Binding ToggleFullScreenCommand}" />
      </myBehaviour:MouseCenterClickTrigger>

      <myBehaviour:MouseWheelTrigger x:ConnectionId='21' x:Name="ZommingMouseWheelTrigger" IsEnabled="False">
        <myBehaviour:MouseWheelTrigger.UpActions>
          <core:InvokeCommandAction x:ConnectionId='44'                                  />
        </myBehaviour:MouseWheelTrigger.UpActions>
        <myBehaviour:MouseWheelTrigger.DownActions>
          <core:InvokeCommandAction x:ConnectionId='45'                                    />
        </myBehaviour:MouseWheelTrigger.DownActions>
      </myBehaviour:MouseWheelTrigger>

      <myBehaviour:PointerCursolAutoHideBehavior x:ConnectionId='22' x:Name="PointerCursolAutoHideBehavior" IsAutoHideEnabled="False" />

      <!-- GamePad Input-->
      <uiNavigation:UINavigationTriggerBehavior x:ConnectionId='23' x:Name="GamePadLeftTriggerBehavior" Kind="Left" IsRequireFocus="True">
        <core:InvokeCommandAction x:ConnectionId='43'                                                         />
      </uiNavigation:UINavigationTriggerBehavior>
      <uiNavigation:UINavigationTriggerBehavior x:ConnectionId='24' x:Name="GamePadRightTriggerBehavior" Kind="Right" IsRequireFocus="True">
        <core:InvokeCommandAction x:ConnectionId='42'                                                         />
      </uiNavigation:UINavigationTriggerBehavior>
      <uiNavigation:UINavigationTriggerBehavior x:ConnectionId='25' x:Name="ReverseGamePadLeftTriggerBehavior" Kind="Left" IsRequireFocus="True" IsEnabled="False">
        <core:InvokeCommandAction x:ConnectionId='41'                                                         />
      </uiNavigation:UINavigationTriggerBehavior>
      <uiNavigation:UINavigationTriggerBehavior x:ConnectionId='26' x:Name="ReverseGamePadRightTriggerBehavior" Kind="Right" IsRequireFocus="True" IsEnabled="False">
        <core:InvokeCommandAction x:ConnectionId='40'                                                         />
      </uiNavigation:UINavigationTriggerBehavior>

      <uiNavigation:UINavigationTriggerBehavior x:ConnectionId='27' x:Name="GamePadRTTriggerBehavior" Kind="PageUp" IsRequireFocus="True" IsEnabled="True">
        <core:InvokeCommandAction x:ConnectionId='39'                                                                />
      </uiNavigation:UINavigationTriggerBehavior>
      <uiNavigation:UINavigationTriggerBehavior x:ConnectionId='28' x:Name="GamePadLTTriggerBehavior" Kind="PageDown" IsRequireFocus="True" IsEnabled="True">
        <core:InvokeCommandAction x:ConnectionId='38'                                                              />
      </uiNavigation:UINavigationTriggerBehavior>
      <uiNavigation:UINavigationTriggerBehavior x:ConnectionId='29' x:Name="GamePadRightStickRightTriggerBehavior" Kind="ScrollRight" IsRequireFocus="True" IsEnabled="True">
        <core:InvokeCommandAction x:ConnectionId='37'                                                             />
      </uiNavigation:UINavigationTriggerBehavior>
      <uiNavigation:UINavigationTriggerBehavior x:ConnectionId='30' x:Name="GamePadRightStickLeftTriggerBehavior" Kind="ScrollLeft" IsRequireFocus="True" IsEnabled="True">
        <core:InvokeCommandAction x:ConnectionId='36'                                                            />
      </uiNavigation:UINavigationTriggerBehavior>
      <uiNavigation:UINavigationTriggerBehavior x:ConnectionId='31' x:Name="GamePadRightStickUpTriggerBehavior" Kind="ScrollUp" IsRequireFocus="True" IsEnabled="True">
        <core:InvokeCommandAction x:ConnectionId='35'                                                          />
      </uiNavigation:UINavigationTriggerBehavior>
      <uiNavigation:UINavigationTriggerBehavior x:ConnectionId='32' x:Name="GamePadRightStickDownTriggerBehavior" Kind="ScrollDown" IsRequireFocus="True" IsEnabled="True">
        <core:InvokeCommandAction x:ConnectionId='34'                                                            />
      </uiNavigation:UINavigationTriggerBehavior>

      <uiNavigation:UINavigationTriggerBehavior Kind="View">
        <core:InvokeCommandAction x:ConnectionId='33' x:Name="GamePadBottomUIToggleAction"                                            />
      </uiNavigation:UINavigationTriggerBehavior>


    </i:Interaction.Behaviors>

    <Grid x:ConnectionId='50' x:Name="ContentContainer">
      <Grid.RenderTransform>
        <TranslateTransform />
      </Grid.RenderTransform>

      <Grid x:ConnectionId='105' uwpUIExtensions:FrameworkElementExtensions.EnableActualSizeBinding="True"
            x:Name="ImagesContainer"
            Background="Transparent"
            IsTapEnabled="True"
            >

        <i:Interaction.Behaviors>
          <!-- Image sizing -->
          <core:EventTriggerBehavior EventName="Loaded">
            <core:ChangePropertyAction x:ConnectionId='110'                                                      PropertyName="Value" Value="{Binding ElementName=ImagesContainer, Path=(uwpUIExtensions:FrameworkElementExtensions.ActualWidth)}" />
            <core:ChangePropertyAction x:ConnectionId='111'                                                      PropertyName="Value" Value="{Binding ElementName=ImagesContainer, Path=(uwpUIExtensions:FrameworkElementExtensions.ActualHeight)}" />
          </core:EventTriggerBehavior>
          <core:EventTriggerBehavior EventName="SizeChanged">
            <core:ChangePropertyAction x:ConnectionId='107'                                                      PropertyName="Value" Value="{Binding ElementName=ImagesContainer, Path=(uwpUIExtensions:FrameworkElementExtensions.ActualWidth)}" />
            <core:ChangePropertyAction x:ConnectionId='108'                                                       PropertyName="Value" Value="{Binding ElementName=ImagesContainer, Path=(uwpUIExtensions:FrameworkElementExtensions.ActualHeight)}" />
            <core:InvokeCommandAction x:ConnectionId='109'                                                        />
          </core:EventTriggerBehavior>
        </i:Interaction.Behaviors>
        <Grid.Resources>
          <Style TargetType="muxc:ItemsRepeater">
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="VerticalCacheLength" Value="100000" />
            <Setter Property="HorizontalCacheLength" Value="100000" />
            <Setter Property="ItemTemplate">
              <Setter.Value>
                <DataTemplate                         >
                  <Image x:ConnectionId='113'                   Stretch="Uniform" />
                </DataTemplate>
              </Setter.Value>
            </Setter>
            <Setter Property="Layout">
              <Setter.Value>
                <muxc:FlowLayout Orientation="Horizontal"
                           LineAlignment="Center"
                           />
              </Setter.Value>
            </Setter>
          </Style>
        </Grid.Resources>

        <muxc:ItemsRepeater x:ConnectionId='114'                                                        
                    x:Name="ImageItemsControl_0"   
                            DataContext="{x:Null}"
                    >
          <muxc:ItemsRepeater.RenderTransform>
            <TranslateTransform X="-10000" />
          </muxc:ItemsRepeater.RenderTransform>
        </muxc:ItemsRepeater>

        <muxc:ItemsRepeater x:ConnectionId='115'                                                        
                    x:Name="ImageItemsControl_1"  
                            DataContext="{x:Null}"
                    >
          <muxc:ItemsRepeater.RenderTransform>
            <TranslateTransform X="-10000" />
          </muxc:ItemsRepeater.RenderTransform>
        </muxc:ItemsRepeater>
        <muxc:ItemsRepeater x:ConnectionId='116'                                                        
                    x:Name="ImageItemsControl_2"  
                            DataContext="{x:Null}"
                    >
          <muxc:ItemsRepeater.RenderTransform>
            <TranslateTransform X="-10000" />
          </muxc:ItemsRepeater.RenderTransform>
        </muxc:ItemsRepeater>
      </Grid>

      <Grid >
        <Rectangle x:ConnectionId='106' x:Name="ImageLoadingBarrier" Stretch="UniformToFill" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Fill="Black" Opacity="0.0"  />
      </Grid>
    </Grid>


    <!-- コントロールUI（共通）-->
    <Grid x:ConnectionId='51' x:Name="UIContainer" >
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="3*" />
        <ColumnDefinition Width="4*" />
        <ColumnDefinition Width="3*" />
      </Grid.ColumnDefinitions>
      <Button x:ConnectionId='100' x:Name="LeftPageMoveButton"
                                                               
              Grid.Column="0"
              Opacity="0"
              HorizontalContentAlignment="Stretch"
              VerticalContentAlignment="Stretch"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Stretch"
              KeyboardAcceleratorPlacementMode="Hidden"
              >
        <Button.KeyboardAccelerators>
          <KeyboardAccelerator Key="Left" />
          <KeyboardAccelerator Key="LeftButton" />
        </Button.KeyboardAccelerators>

        <Border VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
          <SymbolIcon Symbol="Back" />
        </Border>

      </Button>

      <Button x:ConnectionId='101' x:Name="ReverseLeftPageMoveButton"
                                                               
              Grid.Column="0"
              Opacity="0"
              HorizontalContentAlignment="Stretch"
              VerticalContentAlignment="Stretch"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Stretch"
              KeyboardAcceleratorPlacementMode="Hidden"
              IsEnabled="False"
              >
        <Button.KeyboardAccelerators>
          <KeyboardAccelerator Key="Left" />
          <KeyboardAccelerator Key="LeftButton" />
        </Button.KeyboardAccelerators>

        <Border VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
          <SymbolIcon Symbol="Back" />
        </Border>

      </Button>

      <Border x:ConnectionId='102' x:Name="ToggleMenuButton"
              Grid.Column="1"
              Grid.ColumnSpan="1"
              Opacity="0" 
              Background="Transparent"
              IsHitTestVisible="True"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Stretch"
              KeyboardAcceleratorPlacementMode="Hidden" />

      <Button x:ConnectionId='103' x:Name="RightPageMoveButton"
                                                               
              Grid.Column="2"
              Opacity="0"
              HorizontalContentAlignment="Stretch"
              VerticalContentAlignment="Stretch"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Stretch"
              KeyboardAcceleratorPlacementMode="Hidden"
              >
        <Button.KeyboardAccelerators>
          <KeyboardAccelerator Key="Right" />
          <KeyboardAccelerator Key="RightButton" />

        </Button.KeyboardAccelerators>

        <SymbolIcon Symbol="Forward" />
      </Button>

      <Button x:ConnectionId='104' x:Name="ReverseRightPageMoveButton"
                                                               
              Grid.Column="2"
              Opacity="0"
              HorizontalContentAlignment="Stretch"
              VerticalContentAlignment="Stretch"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Stretch"
              KeyboardAcceleratorPlacementMode="Hidden"
              IsEnabled="False"
              >
        <Button.KeyboardAccelerators>
          <KeyboardAccelerator Key="Right" />
          <KeyboardAccelerator Key="RightButton" />

        </Button.KeyboardAccelerators>

        <SymbolIcon Symbol="Forward" />
      </Button>
    </Grid>

    <Grid x:ConnectionId='52' x:Name="IntaractionWall" IsTapEnabled="True" Background="Transparent" />
    
    <!-- ボタン類 -->
    <StackPanel x:ConnectionId='53' x:Name="ButtonsContainer" 
                Background="{ThemeResource SystemControlBaseHighAcrylicElementBrush}"  
                Grid.ColumnSpan="3"
                VerticalAlignment="Top" 
                HorizontalAlignment="Center"
                IsHitTestVisible="True"
                CornerRadius="8"
                Orientation="Horizontal"
                Padding="4 4"
                Margin="0 48 0 0"
                Spacing="4"             
                Windows10version1903:Translation="0, 0, 16"
                >
      <Windows10version1903:StackPanel.Shadow>
        <ThemeShadow  />
      </Windows10version1903:StackPanel.Shadow>

      <animation:Implicit.ShowAnimations>
        <animation:TranslationAnimation To="0, 0" EasingType="Cubic" Duration="0:0:0.175" />
      </animation:Implicit.ShowAnimations>
      <animation:Implicit.HideAnimations>
        <animation:TranslationAnimation To="0, -88" EasingType="Cubic" Duration="0:0:0.175" />
      </animation:Implicit.HideAnimations>

      <StackPanel.Resources>
        <Style TargetType="Button">
          <Setter Property="Height" Value="40" />
          <Setter Property="Width" Value="40" />
          <Setter Property="Padding" Value="0" />
          <Setter Property="CornerRadius" Value="4" />
          <Setter Property="Background" Value="Transparent" />
        </Style>
        <Style TargetType="ToggleButton">
          <Setter Property="Height" Value="40" />
          <Setter Property="Width" Value="40" />
          <Setter Property="Padding" Value="0" />
          <Setter Property="CornerRadius" Value="4" />
          <Setter Property="Background" Value="Transparent" />
        </Style>
        <Style TargetType="SymbolIcon">
          <Setter Property="RenderTransformOrigin" Value="0.5, 0.5" />
          <Setter Property="RenderTransform">
            <Setter.Value>
              <ScaleTransform ScaleX="0.8" ScaleY="0.8" />
            </Setter.Value>
          </Setter>
        </Style>
      </StackPanel.Resources>

      <Button x:ConnectionId='91' x:Name="BottomUIBackNavigationButton"                       >
        <SymbolIcon Symbol="Clear" />
      </Button>

      <Border Width="12" />

      <Button x:ConnectionId='92' x:Name="ZoomResetButton" Command="{StaticResource ZoomResetUICommand}">
        <SymbolIcon Symbol="Zoom" />
      </Button>

      <Button x:ConnectionId='93' x:Name="ZoomInButton" Command="{StaticResource ZoomInUICommand}">
        <SymbolIcon Symbol="ZoomIn" />
      </Button>

      <Button x:ConnectionId='94' x:Name="ZoomOutButton" Command="{StaticResource ZoomOutUICommand}">
        <SymbolIcon Symbol="ZoomOut" />
      </Button>

      <Button x:ConnectionId='95' x:Name="DoubleViewCorrectButton" 
              Command="{StaticResource DoubleViewCorrectUICommand}"
                                                                                    
              Foreground="{ThemeResource ButtonDisabledForegroundThemeBrush}"
              >
        <Button.Content>
          <Grid>
            <fluentIcon:FluentSymbolIcon Symbol="BookPulse24">
              <fluentIcon:FluentSymbolIcon.RenderTransform>
                <TranslateTransform X="-2" Y="-1"/>
              </fluentIcon:FluentSymbolIcon.RenderTransform>
            </fluentIcon:FluentSymbolIcon>
          </Grid>
        </Button.Content>
      </Button>

      <ToggleButton x:ConnectionId='96' x:Name="DoubleViewToggleButton"                                                                 
                    Command="{StaticResource DoubleViewToggleUICommand}"  
                    >
        <ToggleButton.Content>
          <fluentIcon:FluentSymbolIcon Symbol="BookOpen24" Foreground="{ThemeResource ApplicationForegroundThemeBrush}">
            <fluentIcon:FluentSymbolIcon.RenderTransform>
              <TranslateTransform X="-1" Y="-1"/>
            </fluentIcon:FluentSymbolIcon.RenderTransform>
          </fluentIcon:FluentSymbolIcon>
        </ToggleButton.Content>
      </ToggleButton>

      <ToggleButton x:ConnectionId='97' x:Name="LeftBindingToggleButton"                                                                  
                    Command="{StaticResource LeftBindingToggleUICommand}">
        <ToggleButton.Content>
          <fluentIcon:FluentSymbolIcon Symbol="ArrowImport20Filled">
            <fluentIcon:FluentSymbolIcon.RenderTransform>
              <TranslateTransform X="-1" Y="-1"/>
            </fluentIcon:FluentSymbolIcon.RenderTransform>
          </fluentIcon:FluentSymbolIcon>
        </ToggleButton.Content>
      </ToggleButton>
      <Button x:ConnectionId='98' x:Name="ImagesSortButton" Flyout="{StaticResource PageFlyout}" >
        <Button.Content>
          <fluentIcon:FluentSymbolIcon Symbol="TextSortAscending24" />
        </Button.Content>
      </Button>

      
      <Button x:ConnectionId='99' x:Name="OthersSettingsButton" Flyout="{StaticResource OtherSettingsFlyout}"
                                                     
              Visibility="Collapsed"
                  >
        <SymbolIcon Symbol="More" />
      </Button>

    </StackPanel>



    <Border x:ConnectionId='54' x:Name="ImageSelectorContainer" Background="{ThemeResource SystemControlBaseHighAcrylicElementBrush}" 
              Grid.ColumnSpan="3"
              VerticalAlignment="Bottom"
              HorizontalAlignment="Center"
            MinWidth="380"
              MaxWidth="420"
              CornerRadius="8"
              Margin="0 0 0 16"
            Windows10version1903:Translation="0, 0, 16"
              >

      <Windows10version1903:Border.Shadow>
        <ThemeShadow  />
      </Windows10version1903:Border.Shadow>
      
      <animation:Implicit.ShowAnimations>
        <animation:TranslationAnimation To="0, 0" EasingType="Cubic" Duration="0:0:0.175" />
      </animation:Implicit.ShowAnimations>
      <animation:Implicit.HideAnimations>
        <animation:TranslationAnimation To="0, 180" EasingType="Cubic" Duration="0:0:0.175" />
      </animation:Implicit.HideAnimations>

      <StackPanel Margin="8" Spacing="4">

        <Grid>
          <Grid.Resources>
            <ScaleTransform x:Key="FavoriteIconTransform" ScaleX="0.9" ScaleY="0.9" />
          </Grid.Resources>
          <Grid.ColumnDefinitions>
            <ColumnDefinition />
            <ColumnDefinition Width="16" />
            <ColumnDefinition />
          </Grid.ColumnDefinitions>

          <muxc:DropDownButton x:ConnectionId='71' x:Name="Page1ActionButton" Grid.Column="0" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" Margin="0 0 0 0">
            <uwpControls:DockPanel>
              <SymbolIcon x:ConnectionId='82' Symbol="Favorite"                                                      uwpControls:DockPanel.Dock="Left" Margin="0 0 4 0" RenderTransform="{StaticResource FavoriteIconTransform}" RenderTransformOrigin="0.5, 0.5" />
              <TextBlock VerticalAlignment="Center" FontSize="12" Margin="0 0 0 0"  HorizontalAlignment="Center" TextWrapping="Wrap" MaxLines="1" TextTrimming="CharacterEllipsis">
              <Run x:ConnectionId='83'                                            />
              </TextBlock>
            </uwpControls:DockPanel>

            <muxc:DropDownButton.Flyout>
              <MenuFlyout>
                <MenuFlyoutItem x:ConnectionId='84' x:Name="Page1AddFavoriteButton" Text="{i18nExt:Localize Key=AddFavoriteImage}"                                                                                                                      Visibility="Collapsed" />
                <MenuFlyoutItem x:ConnectionId='85' x:Name="Page1RemoveFavoriteButton" Text="{i18nExt:Localize Key=RemoveFavoriteImage}"                                                                                                                         Visibility="Collapsed" />
                <MenuFlyoutItem x:ConnectionId='86' Text="{i18nExt:Localize Key=EditAlbamImage}"                                                                                                                        />
                <MenuFlyoutSeparator />
                <MenuFlyoutItem x:ConnectionId='87' x:Name="Page1SetThubmailImageButton" Text="{i18nExt:Localize Key=SetThumbnailImage}"                                                                                                                                          />
                <MenuFlyoutSeparator x:ConnectionId='88' x:Name="Page1ThumbnailImageSeparator" />
                <MenuFlyoutItem x:ConnectionId='89' x:Name="Page1OpenWithExplorerButton" Text="{i18nExt:Localize Key=OpenWithExplorer}"                                                                                                                           />
                <MenuFlyoutItem x:ConnectionId='90' x:Name="Page1OpenWithExternalAppButton" Text="{i18nExt:Localize Key=OpenWithExternalApplication}"                                                                                                                                      />
              </MenuFlyout>
            </muxc:DropDownButton.Flyout>
          </muxc:DropDownButton >
          <muxc:DropDownButton x:ConnectionId='72' x:Name="Page2ActionButton" Grid.Column="2" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" Margin="0 0 0 0">
            <uwpControls:DockPanel>
              <SymbolIcon x:ConnectionId='73' Symbol="Favorite"                                                      uwpControls:DockPanel.Dock="Left" Margin="0 0 4 0" RenderTransform="{StaticResource FavoriteIconTransform}" RenderTransformOrigin="0.5, 0.5" />
              <TextBlock VerticalAlignment="Center" FontSize="12" Margin="0 0 0 0"  HorizontalAlignment="Center" TextWrapping="Wrap" MaxLines="1" TextTrimming="CharacterEllipsis">
              <Run x:ConnectionId='74'                                            />
              </TextBlock>
            </uwpControls:DockPanel>

            <muxc:DropDownButton.Flyout>
              <MenuFlyout>
                <MenuFlyoutItem x:ConnectionId='75' x:Name="Page2AddFavoriteButton" Text="{i18nExt:Localize Key=AddFavoriteImage}"                                                                                                                      Visibility="Collapsed" />
                <MenuFlyoutItem x:ConnectionId='76' x:Name="Page2RemoveFavoriteButton" Text="{i18nExt:Localize Key=RemoveFavoriteImage}"                                                                                                                         Visibility="Collapsed" />
                <MenuFlyoutItem x:ConnectionId='77' Text="{i18nExt:Localize Key=EditAlbamImage}"                                                                                                                        />
                <MenuFlyoutSeparator />
                <MenuFlyoutItem x:ConnectionId='78' x:Name="Page2SetThubmailImageButton" Text="{i18nExt:Localize Key=SetThumbnailImage}"                                                                                                                                          />
                <MenuFlyoutSeparator x:ConnectionId='79' x:Name="Page2ThumbnailImageSeparator" />
                <MenuFlyoutItem x:ConnectionId='80' x:Name="Page2OpenWithExplorerButton" Text="{i18nExt:Localize Key=OpenWithExplorer}"                                                                                                                           />
                <MenuFlyoutItem x:ConnectionId='81' x:Name="Page2OpenWithExternalAppButton" Text="{i18nExt:Localize Key=OpenWithExternalApplication}"                                                                                                                                      />
              </MenuFlyout>
            </muxc:DropDownButton.Flyout>
          </muxc:DropDownButton>
        </Grid>
        

        
        <!-- ComboBox に対するフォーカス移動が意図どおり出来ないので
             XYFocus*を使って強制的に移動先を指定している 
        -->
        <ComboBox x:ConnectionId='67' x:Name="PageFolderNamesSelector" uwpControls:DockPanel.Dock="Top"
                  ItemsSource="{Binding PageFolderNames}"
                  SelectedItem="{Binding PageFolderName, Mode=TwoWay}"
                  SelectionChangedTrigger="Committed"
                  ToolTipService.ToolTip="{i18nExt:Localize Key=CurrentFolder_InArchive}"
                  HorizontalAlignment="Stretch"
                  HorizontalContentAlignment="Center"
                  Margin="0 4"
                  >
          <i:Interaction.Behaviors>
            <core:EventTriggerBehavior EventName="SelectionChanged">
              <core:InvokeCommandAction x:ConnectionId='70' Command="{Binding ChangePageFolderCommand}"                                                                                />
              <core:CallMethodAction TargetObject="{Binding ElementName=PageFlyout}" MethodName="Hide" />
            </core:EventTriggerBehavior>
          </i:Interaction.Behaviors>

        </ComboBox>


        <Slider x:ConnectionId='68' x:Name="PageSelector" uwpControls:DockPanel.Dock="Bottom"
                Value="{Binding CurrentImageIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                Minimum="0"
                Maximum="{Binding Images.Length, Converter={StaticResource NumberMinus1Converter}}"
                ThumbToolTipValueConverter="{StaticResource NumberStartFrom1Converter}"
                TickFrequency="1"
                StepFrequency="1"
                Padding="0"     
                Margin="0 0"       
                                                              
                >
          <i:Interaction.Behaviors>
            <core:EventTriggerBehavior EventName="ValueChanged">
              <core:InvokeCommandAction Command="{Binding ChangePageCommand}" InputConverter="{StaticResource SliderValueChangedEventArgsConverter}" />
            </core:EventTriggerBehavior>
          </i:Interaction.Behaviors>
        </Slider>

        <TextBlock VerticalAlignment="Center" FontSize="12" Margin="0 0" HorizontalAlignment="Right" uwpControls:DockPanel.Dock="Bottom">

          <TextBlock.RenderTransform>
            <TranslateTransform Y="-6" />
          </TextBlock.RenderTransform>
          <Run x:ConnectionId='69'                                                                 />/<Run Text="{Binding Images.Length}" />
        </TextBlock>

      </StackPanel>

    </Border>

    <Grid x:ConnectionId='55' x:Name="ZoomingControlUI" Visibility="Collapsed"
          Background="{ThemeResource SystemControlBaseHighAcrylicElementBrush}"
          Windows10version1903:Translation="0, 0, 16"
          VerticalAlignment="Top"
          HorizontalAlignment="Center"
          Margin="16 48 16 0"
          Padding="16 8"
          CornerRadius="8"
          IsHitTestVisible="False"
          >
      <Windows10version1903:Grid.Shadow>
        <ThemeShadow />
      </Windows10version1903:Grid.Shadow>

      <animation:Implicit.ShowAnimations>
        <animation:OpacityAnimation To="1.0" Duration="0:0:0.175" />
      </animation:Implicit.ShowAnimations>
      <animation:Implicit.HideAnimations>
        <animation:OpacityAnimation To="0" Duration="0:0:0.175" />
      </animation:Implicit.HideAnimations>

      <animation:Explicit.Animations>
        <animation:AnimationSet x:ConnectionId='62' x:Name="ShowWithinButtonsContainer">
          <animation:TranslationAnimation To="0, 56" EasingType="Cubic" Duration="0:0:0.175" />
        </animation:AnimationSet>
        <animation:AnimationSet x:ConnectionId='63' x:Name="ShowWithoutButtonsContainer">
          <animation:TranslationAnimation To="0, 0" EasingType="Cubic" Duration="0:0:0.175" />
        </animation:AnimationSet>
      </animation:Explicit.Animations>


      <i:Interaction.Behaviors>
        <core:DataTriggerBehavior x:ConnectionId='64'                                                             Value="Visible" >
          <behaviours:StartAnimationAction Animation="{Binding ElementName=ShowWithinButtonsContainer}" />
        </core:DataTriggerBehavior>
        <core:DataTriggerBehavior x:ConnectionId='65'                                                             Value="Collapsed" >
          <behaviours:StartAnimationAction Animation="{Binding ElementName=ShowWithoutButtonsContainer}" />
        </core:DataTriggerBehavior>
      </i:Interaction.Behaviors>


      <TextBlock Style="{StaticResource SubtitleTextBlockStyle}" >
        x<Run x:ConnectionId='66'                                                          />
      </TextBlock>
    </Grid>
    
    <!-- 補助コントロールUI（デスクトップ） -->
    <Grid x:ConnectionId='56' Height="32" x:Name="Toolbar_Desktop" VerticalAlignment="Top" Opacity="1.0" Background="{ThemeResource ApplicationHeaderBackgroundBrush}" >
      <Grid.RenderTransform>
        <TranslateTransform Y="-1" />
      </Grid.RenderTransform>

      <Grid x:ConnectionId='57' x:Name="DraggableTitleBarArea_Desktop" IsHitTestVisible="True" Background="Transparent"  Height="32" VerticalAlignment="Top" />

      <uwpControls:DockPanel x:ConnectionId='58' x:Name="TopBarContainer" Visibility="Collapsed">
        <Button x:ConnectionId='59'                                              uwpControls:DockPanel.Dock="Left" Height="32" Width="48" Style="{ThemeResource AccentButtonStyle}" Opacity="0.6">
          <SymbolIcon Symbol="Back">
            <SymbolIcon.RenderTransform>
              <ScaleTransform ScaleX="0.6" ScaleY="0.6" CenterX="10" CenterY="10" />
            </SymbolIcon.RenderTransform>
          </SymbolIcon>
        </Button>

        <!--
        <Border BorderBrush="{ThemeResource SystemBaseMediumLowColor}" BorderThickness="0 0 0 0"
                uwpControls:DockPanel.Dock="Right" Margin="0 6 184 6"
                />
        -->

        <Border BorderBrush="{ThemeResource SystemBaseMediumLowColor}" BorderThickness="0 0 0 0"
                uwpControls:DockPanel.Dock="Right" Margin="0 6 144 6"
                MinWidth="40"
                >
          <TextBlock VerticalAlignment="Center" FontSize="12" Margin="8 0 0 0" HorizontalAlignment="Right" uwpControls:DockPanel.Dock="Bottom">
            <Run x:ConnectionId='61'                                                                 />/<Run Text="{Binding Images.Length}" />
          </TextBlock>

        </Border>
        
        <StackPanel Orientation="Horizontal" uwpControls:DockPanel.Dock="Right" Spacing="8">
          <Button Height="40" MaxWidth="120" Background="Transparent" Command="{StaticResource FullScreenToggleUICommand}" Opacity="0.7">
            <Button.RenderTransform>
              <TranslateTransform Y="1" />
            </Button.RenderTransform>
          </Button>
        </StackPanel>

        <StackPanel Orientation="Horizontal" Spacing="4">

          <TextBlock TextTrimming="CharacterEllipsis" VerticalAlignment="Center" FontSize="12" Margin="8 0" IsHitTestVisible="False">
              <Run x:ConnectionId='60'                                        />
          </TextBlock>
        </StackPanel>
      </uwpControls:DockPanel>
    </Grid>



    <VisualStateManager.VisualStateGroups>

      <!-- 画像読み込み中の画面演出 -->
      <VisualStateGroup>
        <VisualState>
          <VisualState.StateTriggers>
            <StateTrigger x:ConnectionId='144'                                                                 />
          </VisualState.StateTriggers>
          <VisualState.Storyboard>
            <Storyboard>
              <DoubleAnimation Duration="0:0:0.125"
                               To="0.25"
                               Storyboard.TargetName="ImageLoadingBarrier"
                               Storyboard.TargetProperty="Opacity"
                               />
            </Storyboard>
          </VisualState.Storyboard>
        </VisualState>
        <VisualState>
          <VisualState.StateTriggers>
            <StateTrigger IsActive="True" />
          </VisualState.StateTriggers>
          <VisualState.Storyboard>
            <Storyboard>
              <DoubleAnimation Duration="0:0:0.125"
                               To="0.0"
                               Storyboard.TargetName="ImageLoadingBarrier"
                               Storyboard.TargetProperty="Opacity"
                               />
            </Storyboard>
          </VisualState.Storyboard>
        </VisualState>

      </VisualStateGroup>


      <VisualStateGroup>
        <VisualState>
          <VisualState.StateTriggers>
            <wst:EqualsStateTrigger x:ConnectionId='143'                                                            EqualTo="0" />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="ImageItemsControl_0.(UIElement.RenderTransform).(TranslateTransform.X)" Value="0" />
          </VisualState.Setters>
        </VisualState>
        <VisualState>
          <VisualState.StateTriggers>
            <wst:EqualsStateTrigger x:ConnectionId='142'                                                            EqualTo="1" />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="ImageItemsControl_1.(UIElement.RenderTransform).(TranslateTransform.X)" Value="0" />
          </VisualState.Setters>
        </VisualState>
        <VisualState>
          <VisualState.StateTriggers>
            <wst:EqualsStateTrigger x:ConnectionId='141'                                                            EqualTo="2" />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="ImageItemsControl_2.(UIElement.RenderTransform).(TranslateTransform.X)" Value="0" />
          </VisualState.Setters>
        </VisualState>
      </VisualStateGroup>
      
      <!-- マウスカーソルの自動非表示 -->
      <VisualStateGroup>
        <VisualState>
          <VisualState.StateTriggers>
            <myStateTriggers:PointerCollisionTrigger x:ConnectionId='137'                            CollisionRect="0 0 5000 64" />
            <StateTrigger x:ConnectionId='138'                                                                                                          />
            <myStateTriggers:VirualKeyPressingTrigger x:ConnectionId='139' Key="Control"                                                                           />
            <StateTrigger x:ConnectionId='140'                                                    />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="PointerCursolAutoHideBehavior.IsAutoHideEnabled" Value="False" />
          </VisualState.Setters>
        </VisualState>
        <VisualState>
          <VisualState.StateTriggers>
            <wst:CompositeStateTrigger Operator="And">
              <wst:UserInteractionModeTrigger InteractionMode="Mouse" />
              <wst:DeviceFamilyStateTrigger DeviceFamily="Desktop" />
            </wst:CompositeStateTrigger>
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="PointerCursolAutoHideBehavior.IsAutoHideEnabled" Value="True" />
          </VisualState.Setters>
        </VisualState>
      </VisualStateGroup>

            
      <!-- フルスクリーン -->
      <VisualStateGroup>
        <VisualState>
          <VisualState.StateTriggers>
            <wst:CompositeStateTrigger Operator="And">
              <wst:FullScreenModeTrigger IsFullScreen="True" />
              <myStateTriggers:PointerCollisionTrigger x:ConnectionId='136'                            CollisionRect="0 0 5000 64" />
            </wst:CompositeStateTrigger>
          </VisualState.StateTriggers>
          <VisualState.Storyboard>
            <Storyboard>
              <DoubleAnimation Duration="0:0:0.175"
                               To="-1"
                               Storyboard.TargetName="Toolbar_Desktop"
                               Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)"
                               />
              <DoubleAnimation Duration="0:0:0.175"
                               To="32"
                               Storyboard.TargetName="ContentContainer"
                               Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)"
                               />
            </Storyboard>
          </VisualState.Storyboard>
        </VisualState>
        <VisualState>
          <VisualState.StateTriggers>
            <wst:FullScreenModeTrigger IsFullScreen="True" />
          </VisualState.StateTriggers>
          <VisualState.Storyboard>
            <Storyboard>
              <DoubleAnimation Duration="0:0:0.175"
                               To="-32"
                               Storyboard.TargetName="Toolbar_Desktop"
                               Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)"
                               />
              <DoubleAnimation Duration="0:0:0.175"
                               To="-1"
                               Storyboard.TargetName="ContentContainer"
                               Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)"
                               />
            </Storyboard>
          </VisualState.Storyboard>
        </VisualState>

        <VisualState>
          <VisualState.StateTriggers>
            <wst:CompositeStateTrigger Operator="And">
              <wst:UserInteractionModeTrigger InteractionMode="Mouse" />
              <wst:DeviceFamilyStateTrigger DeviceFamily="Desktop" />
            </wst:CompositeStateTrigger>
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="ContentContainer.Margin" Value="0 32 0 0" />
            <Setter Target="Toolbar_Desktop.(UIElement.RenderTransform).(TranslateTransform.Y)" Value="-1" />
            <Setter Target="ContentContainer.(UIElement.RenderTransform).(TranslateTransform.Y)" Value="0" />
          </VisualState.Setters>
        </VisualState>
      </VisualStateGroup>
            
      <!-- 拡大縮小 -->
      <VisualStateGroup>
        <VisualState>
          <VisualState.StateTriggers>
            <StateTrigger x:ConnectionId='135'                                                   />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="ZoomingControlUI.Visibility" Value="Visible" />
          </VisualState.Setters>
        </VisualState>
      </VisualStateGroup>
      
      
      <!-- アルバムかそれ以外かで画像のアクションを表示切り替え -->
      <VisualStateGroup>
        <VisualState>
          <VisualState.StateTriggers>
            <wst:EqualsStateTrigger x:ConnectionId='134' Value="{Binding ItemType}"                                                        />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="Page1SetThubmailImageButton.Visibility" Value="Collapsed" />
            <Setter Target="Page1ThumbnailImageSeparator.Visibility" Value="Collapsed" />
            <Setter Target="Page2SetThubmailImageButton.Visibility" Value="Collapsed" />
            <Setter Target="Page2ThumbnailImageSeparator.Visibility" Value="Collapsed" />
          </VisualState.Setters>
        </VisualState>
        <VisualState>
          <VisualState.StateTriggers>
            <wst:EqualsStateTrigger x:ConnectionId='133' Value="{Binding ItemType}"                                                          />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="Page1OpenWithExplorerButton.Visibility" Value="Collapsed" />
            <Setter Target="Page1OpenWithExternalAppButton.Visibility" Value="Collapsed" />
            <Setter Target="Page2OpenWithExplorerButton.Visibility" Value="Collapsed" />
            <Setter Target="Page2OpenWithExternalAppButton.Visibility" Value="Collapsed" />
          </VisualState.Setters>
        </VisualState>
      </VisualStateGroup>
      
      <!--見開き補正 -->
      <VisualStateGroup>
        <VisualState>
          <VisualState.StateTriggers>
            <StateTrigger x:ConnectionId='132'                                                         />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="DoubleViewCorrectButton.Foreground" Value="{ThemeResource ApplicationForegroundThemeBrush}" />
          </VisualState.Setters>
        </VisualState>
        <VisualState>
          <VisualState.StateTriggers>
            <StateTrigger IsActive="True" />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="Page2ActionButton.Visibility" Value="Collapsed" />
            <Setter Target="Page1ActionButton.(Grid.ColumnSpan)" Value="3" />
          </VisualState.Setters>
        </VisualState>
      </VisualStateGroup>

      <!-- １ページ目のFav -->
      <VisualStateGroup>
        <VisualState>
          <VisualState.StateTriggers>
            <StateTrigger x:ConnectionId='131'                                                    />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="Page1RemoveFavoriteButton.Visibility" Value="Visible" />
          </VisualState.Setters>
        </VisualState>
        <VisualState>
          <VisualState.StateTriggers>
            <StateTrigger IsActive="True" />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="Page1AddFavoriteButton.Visibility" Value="Visible" />
          </VisualState.Setters>
        </VisualState>
      </VisualStateGroup>

      <!-- ２ページ目のFav -->
      <VisualStateGroup>
        <VisualState>
          <VisualState.StateTriggers>
            <StateTrigger x:ConnectionId='130'                                                    />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="Page2RemoveFavoriteButton.Visibility" Value="Visible" />
          </VisualState.Setters>
        </VisualState>
        <VisualState>
          <VisualState.StateTriggers>
            <StateTrigger IsActive="True" />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="Page2AddFavoriteButton.Visibility" Value="Visible" />
          </VisualState.Setters>
        </VisualState>
      </VisualStateGroup>

      <!--見開き表示時の各ページ用アクションボタンの表示 -->
      <VisualStateGroup>
        <VisualState>
          <VisualState.StateTriggers>
            <wst:EqualsStateTrigger x:ConnectionId='129'                                                      EqualTo="False" />
          </VisualState.StateTriggers>
        </VisualState>
        <VisualState>
          <VisualState.StateTriggers>
            <StateTrigger x:ConnectionId='128'                                                                 />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="Page1ActionButton.(Grid.Column)" Value="2" />
            <Setter Target="Page2ActionButton.(Grid.Column)" Value="0" />
          </VisualState.Setters>
        </VisualState>
      </VisualStateGroup>

      <!-- マウススクロールのページ送り -->
      <VisualStateGroup x:ConnectionId='117' x:Name="VSG_MouseScrool">
        <VisualState>
          <VisualState.StateTriggers>
            <myStateTriggers:VirualKeyPressingTrigger x:ConnectionId='126' Key="Control"                                                                           />
            <StateTrigger x:ConnectionId='127'                                                    />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="DefaultMouseWheelTrigger.IsEnabled" Value="False" />
            <Setter Target="ReverseMouseWheelTrigger.IsEnabled" Value="False" />

            <Setter Target="ZommingMouseWheelTrigger.IsEnabled" Value="True" />
          </VisualState.Setters>
        </VisualState>
        <VisualState x:ConnectionId='123' x:Name="VS_MouseScroolNotReadyToDisplay">
          <VisualState.StateTriggers>
            <StateTrigger x:ConnectionId='125'                                                                                                          />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="DefaultMouseWheelTrigger.IsEnabled" Value="False" />
            <Setter Target="ReverseMouseWheelTrigger.IsEnabled" Value="False" />
          </VisualState.Setters>
        </VisualState>
        <VisualState>
          <VisualState.StateTriggers>
            <StateTrigger x:ConnectionId='124'                                                                                           />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="DefaultMouseWheelTrigger.IsEnabled" Value="False" />
            <Setter Target="ReverseMouseWheelTrigger.IsEnabled" Value="True" />
          </VisualState.Setters>
        </VisualState>
      </VisualStateGroup>

      <!-- 画面上のページ送り -->
      <VisualStateGroup>
        <VisualState>
          <VisualState.StateTriggers>
            <StateTrigger x:ConnectionId='119'                                                                                                          />
            <myStateTriggers:VirualKeyPressingTrigger x:ConnectionId='120' Key="Control"                                                                           />
            <StateTrigger x:ConnectionId='121'                                                   />
            <StateTrigger x:ConnectionId='122'                                                   />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="LeftPageMoveButton.IsEnabled" Value="False" />
            <Setter Target="ReverseLeftPageMoveButton.IsEnabled" Value="False" />
            <Setter Target="RightPageMoveButton.IsEnabled" Value="False" />
            <Setter Target="ReverseRightPageMoveButton.IsEnabled" Value="False" />

            <Setter Target="GamePadLeftTriggerBehavior.IsEnabled" Value="False" />
            <Setter Target="ReverseGamePadLeftTriggerBehavior.IsEnabled" Value="False" />
            <Setter Target="GamePadRightTriggerBehavior.IsEnabled" Value="False" />
            <Setter Target="ReverseGamePadRightTriggerBehavior.IsEnabled" Value="False" />
          </VisualState.Setters>
        </VisualState>
        <VisualState>
          <VisualState.StateTriggers>
            <StateTrigger x:ConnectionId='118'                                                                 />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="LeftPageMoveButton.IsEnabled" Value="False" />
            <Setter Target="ReverseLeftPageMoveButton.IsEnabled" Value="True" />
            <Setter Target="RightPageMoveButton.IsEnabled" Value="False" />
            <Setter Target="ReverseRightPageMoveButton.IsEnabled" Value="True" />

            <Setter Target="GamePadLeftTriggerBehavior.IsEnabled" Value="False" />
            <Setter Target="ReverseGamePadLeftTriggerBehavior.IsEnabled" Value="True" />
            <Setter Target="GamePadRightTriggerBehavior.IsEnabled" Value="False" />
            <Setter Target="ReverseGamePadRightTriggerBehavior.IsEnabled" Value="True" />
          </VisualState.Setters>
        </VisualState>
      </VisualStateGroup>


      <!-- アーカイブファイル内のフォルダ名表示の切り替え -->
      <VisualStateGroup>
        <VisualState>
          <VisualState.StateTriggers>
            <!-- x:BindでバインディングしようとするとXaml internal Compile error: C9999 -->
            <wst:CompareStateTrigger Value="{Binding PageFolderNames.Length}" CompareTo="0" Comparison="Equal" />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="PageFolderNamesSelector.Visibility" Value="Collapsed" />
          </VisualState.Setters>
        </VisualState>
      </VisualStateGroup>
      
      <!-- デスクトップ、タッチ、コントローラーそれぞれの表示切替 -->
      <VisualStateGroup>

        <VisualState>
          <VisualState.StateTriggers>
            <wst:DeviceFamilyStateTrigger DeviceFamily="Xbox" />
            <StateTrigger IsActive="{StaticResource DebugTVMode}" />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="ButtonsContainer.Margin" Value="0 48 0 64" />
            <Setter Target="ImageSelectorContainer.Margin" Value="0 32" />
          </VisualState.Setters>
        </VisualState>
        
        <VisualState>
          <VisualState.StateTriggers>
            <wst:UserInteractionModeTrigger InteractionMode="Touch" />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="SwitchFullScreeMenuItem.Visibility" Value="Visible" />
            <Setter Target="Toolbar_Desktop.Background" Value="Transparent" />
          </VisualState.Setters>
        </VisualState>

        <VisualState>
          <VisualState.StateTriggers>
            <wst:DeviceFamilyStateTrigger DeviceFamily="Desktop" />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="TopBarContainer.Visibility" Value="Visible" />
            <Setter Target="SwitchFullScreeMenuItem.Visibility" Value="Visible" />
            
          </VisualState.Setters>
        </VisualState>

        

      </VisualStateGroup>

    </VisualStateManager.VisualStateGroups>

  </Grid>
</Page>

